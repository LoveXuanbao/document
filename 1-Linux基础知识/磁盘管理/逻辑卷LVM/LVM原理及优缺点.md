## 什么是LVM

- LVM，即**Logical Volume Manager（逻辑卷管理）**，是Linux环境下对磁盘分区进行管理的一种机制。

## LVM相关名词概念

| 名词 | 全程            | 说明                                                         |
| :--- | --------------- | :----------------------------------------------------------- |
| PV   | Physical Volume | 物理卷，可以是一块磁盘，也可以是一个分区                     |
| VG   | Volume Group    | 卷组，一个或者多个物理卷的组合，卷组将多个物理卷组合在一起，形成一个可管理的端元，类似于非LVM系统中的物理硬盘 |
| LV   | Logical Volume  | 逻辑卷，由VG划分而来，是在卷组中划分的一个逻辑区域，类似于非LVM系统中的硬盘分区 |
| PE   | Physical Extent | 物理块，具有唯一编号的PE是可以被LVM寻址的最小存储单元，PE的大小是可配置的，默认为4MB |
| LE   | Logical Extent  | 逻辑块，逻辑卷LV也被划分为可被寻址的基本单位，成为LE，在同一个卷组中，LE的带下和PE是相同的，并且一一对应。 |
## LVM的优缺点

### 优点

1. 文件系统可以跨多个磁盘，因此文件系统大小不会受物理磁盘的限制；
2. 可以在系统运行的状态下动态扩展文件系统的大小；
3. LVM的存储空间可以通过新增磁盘的方式扩容；
4. 可以以镜像的方式冗余重要的数据到多个物理磁盘；
5. 可以方便的导出整个卷组到另外一台机器。

### 缺点

1. 在从卷组中移除一个磁盘的时候必须使用**reducevg**命令（这个命令要求root权限，并且不允许在快照卷组中使用）；
2. 当卷组中的一个磁盘损坏时，整个卷组都会受到影响；
3. 因为加入了额外的操作，存储性能受到影响。

## LVM的工作原理

​        通过将底层的物理硬盘抽象的封装起来，然后以逻辑卷的方式呈现给上层应用。在传统的磁盘管理机制中，我们的上层应用是直接访问文件系统，从而对底层的物理硬盘进行读取；而在LVM中，其通过对底层的硬盘进行封装，当我们对底层的物理硬盘进行操作时，其不在是针对分区进行操作，而是通过一个叫做逻辑卷的东西来对其进行底层的磁盘管理操作。比如说我增加了一个物理硬盘，这个时候上层的服务是感觉不到的，因为呈现给上层服务的是以逻辑卷的方式。

## LVM的特点

​        LVM最大的特点就是可以对磁盘进行动态管理。因为逻辑卷的大小是可以动态调整的，而且不会丢失现有的数据。我们如果新增加了硬盘，也不会改变现有的上层的逻辑卷。作为一个动态磁盘管理机制，逻辑卷技术大大提高了磁盘管理的灵活性

## LVM总结

1. 物理磁盘被格式化为PV，空间被划分为一个个的PE；
2. 不同的PV加入到同一个VG中，不同的PV的PE全部进入到VG的PE池内；
3. LV基于PE创建，大小为PE的整数倍，组成LV的PE可能来自不同的物理磁盘；
4. LV创建好后，就可以直接格式化后挂载使用；
5. LV的扩充缩减实际上就是增加或减少组成该LV的PE数量，其过程不会丢失原始数据。