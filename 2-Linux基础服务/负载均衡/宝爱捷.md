```bash
global          
    chroot      /var/lib/haproxy
    pidfile     /var/run/haproxy.pid
    maxconn     20000
    user        haproxy
    group       haproxy
    daemon
    log         /dev/log local2 warning
    nbproc      2


defaults
    log                     global
    option                  redispatch
    option http-keep-alive
    option forwardfor
    option httplog
    retries                 3
    timeout http-request    10s
    timeout queue           1m
    timeout connect         10s
    timeout client          1m
    timeout server          1m
    timeout check           100
    maxconn                 20000
    #option httpchk GET /index.html
    mode http
    balance source

listen  monitor
    bind 0.0.0.0:1936
    maxconn 10
    stats enable
    stats hide-version
    stats refresh 30s
    stats show-node
    stats auth admin:admin
    stats uri  /haproxy?stats


listen pg_master
    bind *:5432
    mode tcp
    timeout client 30h
    timeout server 30h
    option httplog
    option httpchk OPTIONS /master
    http-check expect status 200
    default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions
    server postgresql_172.31.75.121_5432 172.31.75.121:5432  maxconn 5000 check port 8008
    server postgresql_172.31.75.122_5432 172.31.75.122:5432  maxconn 5000 check port 8008
    server postgresql_172.31.75.123_5432 172.31.75.123:5432  maxconn 5000 check port 8008

listen pg_replicas
    bind *:5001
    mode tcp
    timeout client 30h
    timeout server 30h
    option httplog
    option httpchk OPTIONS /replica
    http-check expect status 200
    default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions
    server postgresql_172.31.75.121_5432 172.31.75.121:5432  maxconn 5000 check port 8008
    server postgresql_172.31.75.122_5432 172.31.75.122:5432  maxconn 5000 check port 8008
    server postgresql_172.31.75.123_5432 172.31.75.123:5432  maxconn 5000 check port 8008



frontend web
    bind *:80
    option forwardfor
    option httplog
    option httpclose
    mode http
    acl sso-http hdr_beg(host) -i cdp.paig.com.cn
    acl panel-http hdr_beg(host) -i cdpop.paig.com.cn
    acl secureplus-http hdr_beg(host) -i cdpsecurity.paig.com.cn
    acl dimmetrics-http hdr_beg(host) -i cdpmodel.paig.com.cn
    acl datasocket-http hdr_beg(host) -i cdpintegrat.paig.com.cn
    acl taskflow-http hdr_beg(host) -i cdptask.paig.com.cn
    acl metaspace-http hdr_beg(host) -i cdpmeta.paig.com.cn
    acl datastudio-http hdr_beg(host) -i cdpquery.paig.com.cn
    acl liveinsight-http hdr_beg(host) -i cdpengine.paig.com.cn
    acl gvp-http hdr_beg(host) -i cdpbi.paig.com.cn
    acl datastudio-api-demo hdr_beg(host) -i datastudio-api-demo.gridsumdissector.com
    use_backend sso-http if sso-http
    use_backend panel-http if panel-http
    use_backend secureplus-http if secureplus-http
    use_backend dimmetrics-http if dimmetrics-http
    use_backend datasocket-http if datasocket-http
    use_backend taskflow-http if taskflow-http
    use_backend metaspace-http if metaspace-http
    use_backend datastudio-http if datastudio-http
    use_backend liveinsight-http if liveinsight-http
    use_backend gvp-http if gvp-http
    use_backend datastudio-api-demo if datastudio-api-demo
    # default_backend node2

backend sso-http
    balance roundrobin
    server 172.31.75.101:80 172.31.75.101:80 check port 80 inter 2s fall 2 rise 1 maxconn 30000
#    server 172.31.75.102:8000 172.31.75.102:8000 check port 8000 inter 2s fall 2 rise 1 maxconn 30000


backend panel-http
    balance roundrobin
    server 172.31.75.71:8080 172.31.75.71:8080 check port 8080 inter 2s fall 2 rise 1 maxconn 30000
    server 172.31.75.90:8080 172.31.75.90:8080 check port 8080 inter 2s fall 2 rise 1 maxconn 30000

listen ambari-server-ow_frontend
    bind *:8440
    mode tcp
    option tcplog
    balance roundrobin
    server ambari-server-ow-1 172.31.75.71:8440 check
    server ambari-server-ow-2 172.31.75.90:8440 check backup

listen ambari-server-tw_frontend
    bind *:8441
    mode tcp
    option tcplog
    balance roundrobin
    server ambari-server-tw-1 172.31.75.71:8441 check
    server ambari-server-tw-2 172.31.75.90:8441 check backup

backend secureplus-http
    balance roundrobin
    server 172.31.75.71:6080 172.31.75.71:6080 check port 6080 inter 2s fall 2 rise 1 maxconn 30000
    server 172.31.75.90:6080 172.31.75.90:6080 check port 6080 inter 2s fall 2 rise 1 maxconn 30000

listen SecurePlus3890
    bind 0.0.0.0:3890
#    server SecurePlus2 172.31.75.90:3890 check
    server SecurePlus1 172.31.75.71:3890 check

backend dimmetrics-http
    balance roundrobin
    server 172.31.75.71:8585 172.31.75.71:8585 check port 8585 inter 2s fall 2 rise 1 maxconn 30000
    server 172.31.75.89:8585 172.31.75.89:8585 check port 8585 inter 2s fall 2 rise 1 maxconn 30000

backend datasocket-http
    balance roundrobin
    server 172.31.75.83:4000 172.31.75.83:4000 check port 4000 inter 2s fall 2 rise 1 maxconn 30000
    server 172.31.75.86:4000 172.31.75.86:4000 check port 4000 inter 2s fall 2 rise 1 maxconn 30000

backend taskflow-http
    balance roundrobin
    server 172.31.75.84:9003 172.31.75.84:9003 check port 9003 inter 2s fall 2 rise 1 maxconn 30000
    server 172.31.75.87:9003 172.31.75.87:9003 check port 9003 inter 2s fall 2 rise 1 maxconn 30000

backend metaspace-http
    balance roundrobin
    server 172.31.75.82:21001 172.31.75.82:21001 check port 21001 inter 2s fall 2 rise 1 maxconn 30000
    server 172.31.75.85:21001 172.31.75.85:21001 check port 21001 inter 2s fall 2 rise 1 maxconn 30000

backend datastudio-http
    balance roundrobin
    server 172.31.75.81:7090 172.31.75.81:7090 check port 7090 inter 2s fall 2 rise 1 maxconn 30000
    server 172.31.75.88:7090 172.31.75.88:7090 check port 7090 inter 2s fall 2 rise 1 maxconn 30000

backend datastudio-api-demo
    balance roundrobin
    server 172.31.75.81:9527 172.31.75.81:9527 check port 9527 inter 2s fall 2 rise 1 maxconn 30000
    server 172.31.75.88:9527 172.31.75.88:9527 check port 9527 inter 2s fall 2 rise 1 maxconn 30000

backend liveinsight-http
    balance roundrobin
    server 172.31.75.72:8090 172.31.75.72:8090 check port 8090 inter 2s fall 2 rise 1 maxconn 30000
    server 172.31.75.89:8090 172.31.75.89:8090 check port 8090 inter 2s fall 2 rise 1 maxconn 30000

backend gvp-http
    balance roundrobin
    server 172.31.75.141:8000 172.31.75.141:8000 check port 8000 inter 2s fall 2 rise 1 maxconn 30000

listen impala 
    bind 0.0.0.0:21000
    mode tcp
    option tcplog
    balance leastconn
    server impala_shell_1  172.31.75.71:21000 check
    server impala_shell_2  172.31.75.72:21000 check
    server impala_shell_3  172.31.75.81:21000 check
    server impala_shell_4  172.31.75.82:21000 check
    server impala_shell_5  172.31.75.83:21000 check
    server impala_shell_6  172.31.75.84:21000 check
    server impala_shell_7  172.31.75.85:21000 check
    server impala_shell_8  172.31.75.86:21000 check
    server impala_shell_9  172.31.75.87:21000 check
    server impala_shell_10 172.31.75.88:21000 check
    server impala_shell_11 172.31.75.89:21000 check
    server impala_shell_12 172.31.75.90:21000 check

listen impalajdbc 
    bind 0.0.0.0:21050
    mode tcp
    option tcplog
    balance leastconn
    server impala_jdbc_1  172.31.75.71:21050 check
    server impala_jdbc_2  172.31.75.72:21050 check
    server impala_jdbc_3  172.31.75.81:21050 check
    server impala_jdbc_4  172.31.75.82:21050 check
    server impala_jdbc_5  172.31.75.83:21050 check
    server impala_jdbc_6  172.31.75.84:21050 check
    server impala_jdbc_7  172.31.75.85:21050 check
    server impala_jdbc_8  172.31.75.86:21050 check
    server impala_jdbc_9  172.31.75.87:21050 check
    server impala_jdbc_10 172.31.75.88:21050 check
    server impala_jdbc_11 172.31.75.89:21050 check
    server impala_jdbc_12 172.31.75.90:21050 check


listen datastudio_backend
    bind 0.0.0.0:9527
    mode tcp
    option tcplog
    balance roundrobin
    server datastudio1 172.31.75.81:9527 check inter 1000
    server datastudio2 172.31.75.88:9527 check inter 1000 backup


#listen sso80
#    bind *:80
#    server sso80-1 172.31.75.101:80 check
#    server sso80-2 172.31.75.102:80 check backup

listen SecurePlus6080
    bind 0.0.0.0:6080
    server SecurePlus1 172.31.75.71:6080 check
    server SecurePlus2 172.31.75.90:6080 check
```

