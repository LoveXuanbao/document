

## 配置etcd客户端

```bash
[root@k8s-master-1 etcd]# cat /etc/profile.d/etcdctl.sh 
export ETCDCTL_API=3
export ETCDCTL_ENDPOINTS=https://10.202.43.46:2379,https://10.202.43.55:2379,https://10.202.43.56:2379
export ETCDCTL_CACERT=/etc/etcd/pki/etcd-ca.pem
export ETCDCTL_CERT=/etc/etcd/pki/etcd-client.pem
export ETCDCTL_KEY=/etc/etcd/pki/etcd-client-key.pem
```

## 查看集群中各个端点的健康状况

```bash
[root@k8s-master-1 etcd]# etcdctl endpoint health --write-out=table
+---------------------------+--------+-----------+-------+
|         ENDPOINT          | HEALTH |   TOOK    | ERROR |
+---------------------------+--------+-----------+-------+
| https://10.202.43.46:2379 |   true | 25.4496ms |       |
| https://10.202.43.56:2379 |   true | 34.4044ms |       |
| https://10.202.43.55:2379 |   true | 35.4363ms |       |
+---------------------------+--------+-----------+-------+
```

## 查看集群中各个端点的状态信息

```bash
[root@k8s-master-1 etcd]# etcdctl endpoint status --write-out=table
+---------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
|         ENDPOINT          |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |
+---------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
| https://10.202.43.46:2379 | 213b371db4ce79c0 |   3.5.8 |   20 kB |      true |      false |         2 |         12 |                 12 |        |
| https://10.202.43.55:2379 | 475134c4db631d8a |   3.5.8 |   20 kB |     false |      false |         2 |         12 |                 12 |        |
| https://10.202.43.56:2379 | d186b70cfca4f819 |   3.5.8 |   20 kB |     false |      false |         2 |         12 |                 12 |        |
+---------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
```

**各个字段的解释**

- **ENDPOINT**：这是 etcd 集群中各个成员的访问地址；
- **ID**：每个 etcd 成员都有的一个唯一的 ID，用于在集群中标识自己，这个 ID 是在成员加入集群时自动生成的；
- **VERSION**：表示 etcd 服务的版本号；
- **DB SIZE**：表示 etcd 数据库中的存储的数据大小。这里的单位是字节（kb）；所以，“20 kB” 意味着数据库当前使用了大约 20 千字节的存储空间；
- **IS LEADER**：表示这个端点是否是 etcd 集群的领导者（leader）。在 etcd 中，领导者负责处理所有的写请求，并将数据同步给其他的追随者（followers）；
- **IS LEARNER**：表示这个端点是否是一个学习者（learner）。学习者是 etcd 3.4.0 版本后引入的一个新角色，类似于跟随着，但不参与选举过程，也不会成为领导者。学习者通常用于只读副本或备份；
- **RAFT TERM**：Ratf 协议中的一个概念，表示当前的任期号。每当发生领导者选举时，任期号都会增加，所有成员都需要在同一个任期内才能正常工作；
- **RAFT APPLIED INDEX**：表示已经被应用到 etcd 状态机的最新 Raft 日志条目的索引。换句话说，这是集群中已经生效的最新数据变更的索引。
- **ERRORS**：如果在获取端点状态时发生了错误，这个字段会显示错误信息；